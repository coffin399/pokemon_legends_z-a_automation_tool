# 🎮 Nintendo Switch 自動マクロツール

**超簡単！** ボタン一つでNintendo Switchを自動操作できるツールです。

ZLボタンを押しながらAボタンを自動で連打し続けます。

**ENTERキー**または**CTRL+Y**でマクロの開始/停止を自由に切り替えられます！

---

## 📋 このツールで何ができる？

- **ZL+Aボタンの自動連打** をループ実行
- **ENTERキーで簡単に開始/停止** - いつでも中断・再開可能
- **CTRL+Y でも停止可能** - 素早く止められる
- ゲームの単純作業を自動化できます
- プログラミング知識不要で使えます
- **ワンクリックセットアップ** - ダブルクリックするだけ！

---

## 🎯 初めての方へ

**📄 分かる人向け.txt を開いてください！**

超シンプルな3ステップガイドが書いてあります。

または、以下のガイドから選んでください：

| ガイド                      | 対象    | 所要時間 |
|--------------------------|-------|----------|
| 📄 **分かる人向け.txt**        | やべーやつ | 1分で読める |
| 📘 **SETUP_GUIDE.md**    | 初心者   | 詳細ガイド |
| 📗 **QUICKSTART.md**     | 一般    | 5分で始める |
| 📕 **README.md（このファイル）** | 全員    | 完全版マニュアル |

---

## 🛠️ 必要なもの

### ハードウェア
- ✅ Windows 10 または Windows 11 のPC
- ✅ Bluetooth機能（内蔵またはUSBアダプタ）
- ✅ Nintendo Switch本体

### その他
- インターネット接続（初回セットアップ時のみ）
- 30分程度の時間（初回セットアップ時のみ）

---

## 📁 ファイル構造

ダウンロードしたフォルダの中身：

```
switch-macro/
│
├── 📄 分かる人向け.txt       ← 超シンプルガイド
├── 📄 セットアップガイド.md      ← 超初心者向けガイド
├── 📄 クイックスタート.md        ← 5分で始めるガイド
├── 📄 README.md               ← このファイル
├── 📄 LICENSE                 ← MITライセンス
├── 📄 requirements.txt        ← Python依存パッケージリスト
│
├── 🔧 setup.bat               ← 【初回のみ】ワンクリックセットアップ
├── 🚀 run_macro.bat           ← 【毎回使う】メインマクロ実行
├── 🧪 test_connection.bat     ← 接続テスト
├── 📡 reconnect_bluetooth.bat ← Bluetooth再接続ヘルパー
│
├── 📁 src/                    ← メインソースコード
│   └── switch_macro.py       ← マクロ実行スクリプト
│
└── 📁 scripts/                ← ユーティリティスクリプト
    ├── install_dependencies.sh  ← WSL内自動インストール
    ├── troubleshoot.sh       ← 環境診断ツール
    └── test_connection.py    ← 接続テストスクリプト


```

### 🎯 どのファイルを使う？

| ファイル | いつ使う？ | 説明 |
|---------|-----------|------|
| `setup.bat` | 初回のみ | **ダブルクリック**でワンクリックセットアップ |
| `run_macro.bat` | 毎回 | ZL+A連打マクロを実行 |
| `test_connection.bat` | トラブル時 | 接続テストと診断 |
| `reconnect_bluetooth.bat` | PC再起動後 | Bluetoothを簡単に再接続 |
---

## 🚀 初回セットアップ（30分）

初めて使うときだけ必要な作業です。

### ✨ ワンクリックセットアップ

```
重要！
setup.bat は【ダブルクリック】するだけでOK！
右クリック不要です！
```

### ステップ1: セットアップ実行

1. **`setup.bat` をダブルクリック**
2. 「このアプリがデバイスに変更を加えることを許可しますか？」
   → **「はい」** をクリック
3. 黒い画面が開いて、自動的にインストールが始まります
4. 「セットアップを開始しますか? (Y/N):」と聞かれたら **Y** を入力してEnter

### ステップ2: 自動インストール

以下が自動で実行されます：

- ✅ WSL2のインストール（5分）
- ✅ Ubuntu 22.04のインストール（5分）
- ✅ Python環境のセットアップ（10分）
- ✅ 必要なパッケージのインストール（5分）

```
💡 コーヒーでも飲んで待ちましょう ☕
```

### ステップ3: 再起動（必要な場合）

「再起動が必要です」と表示されたら:

1. **Y** を押して自動再起動
2. 再起動後、**setup.bat をもう一度ダブルクリック**
3. 自動で続きから始まります

### ステップ4: Ubuntu初回設定

新しいウィンドウで「Ubuntu」が起動します。

```
Enter new UNIX username: switch
New password: [好きなパスワード]
Retype new password: [もう一度同じパスワード]
```

```
💡 パスワードは入力しても画面に表示されませんが、
   ちゃんと入力されています！
```

入力が完了したらUbuntuのウィンドウを閉じて、セットアップの画面に戻ります。

### ステップ5: Bluetooth設定（重要！）

#### 5-1. usbipd-winのインストール

セットアップが自動でインストールを試みます。

**失敗した場合のみ手動でインストール:**

1. [https://github.com/dorssel/usbipd-win/releases](https://github.com/dorssel/usbipd-win/releases) を開く
2. 最新の `.msi` ファイルをダウンロード（例: `usbipd-win_4.0.0.msi`）
3. ダブルクリックしてインストール

#### 5-2. BluetoothアダプタをWSLに接続

1. **PowerShell** を開く
   - Windowsキー → 「PowerShell」と入力
   - **右クリック** → 「管理者として実行」

2. Bluetoothアダプタを確認:
   ```powershell
   usbipd list
   ```

3. Bluetoothアダプタを探す（例）:
   ```
   BUSID  VID:PID    DEVICE
   2-3    8087:0025  Intel(R) Wireless Bluetooth(R)
   ```
   👆 この「2-3」の部分をメモ

4. アダプタを接続（BUSIDは自分のものに置き換える）:
   ```powershell
   usbipd bind --busid 2-3
   usbipd attach --wsl --busid 2-3
   ```

5. 確認:
   ```powershell
   wsl -d Ubuntu-22.04
   hciconfig
   ```
   
   「hci0」と表示されればOK！

---

## 🎯 使い方（毎回）

初回セットアップが終わったら、以降は超簡単です！

### 手順

1. **Nintendo Switchの準備**
   - ホーム画面を開く
   - 「コントローラー」を選択
   - 「持ちかた/順番を変える」を選択
   - この画面を開いたままにする

2. **マクロの実行**
   - **`run_macro.bat` をダブルクリック**
   - 「準備ができたら...」と表示されたら **Enter** キーを押す

3. **接続完了**
   - 「✅ 接続成功！」と表示される
   - Switchの画面に新しいコントローラーが表示される

4. **マクロ開始**
   - 💡 操作方法が表示されます
   - **ENTERキーを押す** とマクロが開始されます
   - 自動的にZL+Aボタンが連打され始めます
   - ループ回数が表示されます

5. **マクロ停止・再開**
   - **ENTERキーを押す** → マクロ一時停止
   - **もう一度ENTERキーを押す** → マクロ再開
   - **CTRL+Y を押す** → マクロ停止
   - **CTRL+C を押す** → プログラム終了

---

## 🎮 操作方法まとめ

| キー操作 | 動作 |
|---------|------|
| **ENTER** | マクロ開始 / 一時停止 / 再開 |
| **CTRL+Y** | マクロ停止 |
| **CTRL+C** | プログラム終了・切断 |

```
💡 ポイント
- ENTERキーでいつでもマクロを止めたり再開したりできます
- トイレ休憩やちょっとした用事のときに便利！
- CTRL+Yでも素早く停止できます
```

---

## 🔄 PC再起動後の使い方

PC再起動後は、Bluetoothを再接続する必要があります。

### 🎯 簡単な方法（推奨）

**`reconnect_bluetooth.bat` をダブルクリック**

- 初回は BUSIDを入力
- 2回目以降は自動で前回のBUSIDを使用
- ワンクリックで再接続完了！

### 手動で接続する方法

PowerShell（管理者）で以下を実行:

```powershell
usbipd attach --wsl --busid 2-3
```

（2-3は自分のBUSID）

---

## 🎮 マクロの動作

このマクロは以下を繰り返します:

```
1. ZLボタンを押す（0.5秒）
   ↓
2. ZL+Aを同時に押す（0.1秒）
   ↓
3. 0.5秒待つ
   ↓
4. 最初に戻って繰り返し
   ↓
ENTERキーまたはCTRL+Yを押すまで継続
```

**ENTERキーでいつでも停止・再開できます！**

---

## 🧪 接続テスト（推奨）

マクロを使う前に、正常に動作するか確認しましょう。

### テスト方法

1. Switchで「持ちかた/順番を変える」を開く
2. **`test_connection.bat` をダブルクリック**
3. Enterキーを押す
4. 「✅ すべてのテストが成功しました！」と表示されればOK

Switchの画面に新しいコントローラーが表示され、Aボタンが1回押されます。

---

## ⚠️ トラブルシューティング

### 問題1: 「このアプリが...」と出る

**解決方法**:
- **「はい」** をクリックするだけでOK

---

### 問題2: 「Bluetoothアダプタが見つかりません」

**原因**: BluetoothアダプタがWSLに接続されていない

**解決方法**:

1. **`reconnect_bluetooth.bat` をダブルクリック**

または

2. PowerShell（管理者）で確認:
   ```powershell
   usbipd list
   ```

3. もう一度接続:
   ```powershell
   usbipd attach --wsl --busid 2-3
   ```

---

### 問題3: 「接続できません」

**原因**: Switchの準備ができていない

**解決方法**:
1. Switchの「持ちかた/順番を変える」画面が開いているか確認
2. 他のコントローラーをすべて切断
3. もう一度 `run_macro.bat` を実行

---

### 問題4: ENTERキーやCTRL+Yが効かない

**原因**: ターミナルウィンドウが選択されていない

**解決方法**:
1. マクロが実行されている黒いウィンドウをクリック
2. ENTERキーまたはCTRL+Yを押す

---

### 問題5: 「Permission denied」エラー

**解決方法**:

手動で実行する場合:
```bash
wsl -d Ubuntu-22.04
cd ~/switch-macro
source .venv/bin/activate
sudo python3 src/switch_macro.py
```

---

### 問題6: WSLが起動しない

**解決方法**:

PowerShellで以下を実行:
```powershell
wsl --shutdown
wsl -d Ubuntu-22.04
```

---

### 🔍 自動診断ツール

**`test_connection.bat` をダブルクリック**

失敗したら「Y」を押すと自動で環境を診断してくれます。

---

## 🔧 カスタマイズ（上級者向け）

### 独自のマクロを作る

1. `src/switch_macro.py` をテキストエディタで開く

2. `zl_a_loop()` 関数内のマクロ実行部分を編集:

```python
if macro.is_running:
    loop_count += 1
    print(f"🔄 ループ {loop_count}回目...")

    # ここを編集 ↓↓↓
    
    macro.press_button("ZL", 0.5)        # ZLを0.5秒押す
    macro.press_buttons(["ZL", "A"], 0.1) # ZL+A同時押し0.1秒
    macro.wait(0.5)                      # 0.5秒待つ
    
    # ここまで ↑↑↑
```

### 使えるボタン一覧

| ボタン | コード |
|--------|--------|
| A, B, X, Y | `"A"`, `"B"`, `"X"`, `"Y"` |
| L, R | `"L"`, `"R"` |
| ZL, ZR | `"ZL"`, `"ZR"` |
| 十字キー | `"DPAD_UP"`, `"DPAD_DOWN"`, `"DPAD_LEFT"`, `"DPAD_RIGHT"` |
| システム | `"PLUS"`, `"MINUS"`, `"HOME"`, `"CAPTURE"` |

### 例: Aボタン単体連打

```python
macro.press_button("A", 0.1)  # Aを0.1秒押す
macro.wait(0.5)               # 0.5秒待つ
```

### 例: A+B同時押し

```python
macro.press_buttons(["A", "B"], 0.1)  # A+Bを0.1秒押す
macro.wait(0.5)
```

詳しくは `macros/custom_example.py` を参照してください。

---

## 🗑️ アンインストール

このツールが不要になった場合:

1. PowerShell（管理者）を開く

2. 以下を実行:
   ```powershell
   wsl --unregister Ubuntu-22.04
   ```

3. `switch-macro` フォルダを削除

これで完全に削除されます。

---

## ⚖️ 注意事項

- このツールは**教育目的**で作成されています
- ゲームの利用規約を確認してください
- オンラインゲームでの使用は推奨しません
- 自己責任でご使用ください

---

## ⚠️ リスクと免責事項（重要）

### このツールを使用する前に必ずお読みください

このツールは連射コン/マクロコン同様に**自動化・マクロツール**です。使用にあたって以下のリスクがあることを理解してください。

### 🚨 BANのリスク

#### 1. **Nintendo利用規約違反の可能性**

Nintendoの利用規約では、サービスにアクセスするために「ロボット、スパイダー、クローラー、スクレイパーまたはその他の自動化された手段やインターフェース」を使用することが禁止されています。このマクロツールはBluetoothコントローラーをエミュレートしますが、自動化ツールに該当する可能性があります。

#### 2. **本体・アカウントBANの可能性**

Nintendoは改造やマクロ使用を検知した場合、コンソールBANまたはアカウントBANを実施します。以下のような制限を受ける可能性があります：

- ✗ eShopへのアクセス不可
- ✗ オンラインマルチプレイ不可
- ✗ ゲームアップデートのダウンロード不可
- ✗ オンライン機能（ランキング、クラウドセーブ等）の利用不可
- ✗ フレンド機能の利用不可

#### 3. **最新の規約強化**

2025年5月、Nintendoは利用規約を更新し、規約違反があった場合、Nintendo Switchやサービスを「全体または一部において永久に使用不能にする」権利を明記しました。この規約はNintendo Switch 2にも適用される見込みです。

### 💡 リスクを理解した上での使用

このツールは以下の条件でのみ使用することを推奨します：

1. **完全オフライン専用のSwitch** - 今後一切オンラインに接続しない
2. **サブ機での使用** - メインのSwitchとは別の本体
3. **シングルプレイゲームのみ** - オンライン要素のないゲーム
4. **教育・研究目的** - 技術的な学習のため

### 🛡️ 安全な使用のために

もしこのツールを使用する場合：

- ✅ **メイン機では絶対に使用しない**
- ✅ **オンラインゲームでは絶対に使用しない**
- ✅ **購入したゲームのみで使用する**（海賊版使用は即BAN）
- ✅ **使用後はSwitchをオフラインに保つ**
- ✅ **複数のSwitch本体を持っている場合、マクロ用とオンライン用を完全に分ける**

### ⚖️ 法的責任

このプロジェクトは開発目的で作成されました。作成者およびメンテナーは、使用によって生じたいかなる損害やBANについても責任を負いません。**使用は完全に自己責任です。**

### 🔒 保証の免責

人生において何も保証されるものはありません。この情報は多くの経験に基づいていますが、Nintendoはいつでもどのような行為をBAN対象とするか、またはテレメトリー収集方法を変更する可能性があります。

### 📋 結論

**連射コントローラー/マクロコントローラー同様にこのツールの使用には重大なリスクが伴います。**

- 本体・アカウントがBANされる可能性
- 数万円の本体と購入したゲームが使用不能になる可能性
- オンラインサービスへの永久アクセス不可の可能性

**これらのリスクを完全に理解し、受け入れられる場合のみ使用してください。**

どうしても使用したい場合は：
1. 専用のサブ機を用意
2. 完全オフライン運用を徹底
3. オンライン要素のないゲームのみで使用

**それでも100%安全ではありません。使用は完全に自己責任です。**

---

## 📚 よくある質問（FAQ）

### Q1: どのゲームで使えますか？

**A**: Nintendo Switchのすべてのゲームで動作します。ただし、オンライン対戦では使用しないでください。

### Q2: マクロの速度を変更できますか？

**A**: はい。`src/switch_macro.py` の待機時間（`0.5`の部分）を編集してください。

### Q3: 他のボタン操作もできますか？

**A**: はい。`run_custom_macro.bat` を実行すると6種類のサンプルマクロが選べます。

### Q4: PCがスリープモードになったらどうなりますか？

**A**: 接続が切れます。再度 `run_macro.bat` を実行してください。

### Q5: バッテリー消費は？

**A**: Bluetooth接続なので消費は少なめですが、長時間使用する場合はSwitchを充電しながら使用することを推奨します。

### Q6: setup.batは右クリックが必要ですか？

**A**: いいえ！**ダブルクリックするだけ**でOKです。自動で管理者権限に昇格します。

### Q7: PC再起動後、毎回設定が必要ですか？

**A**: いいえ。`reconnect_bluetooth.bat` をダブルクリックするだけで再接続できます。BUSIDも保存されます。

### Q8: ENTERキーを押しても反応しない

**A**: マクロ実行中の黒いウィンドウ（ターミナル）をクリックしてアクティブにしてから、ENTERキーを押してください。

### Q9: マクロを一時停止して後で再開できますか？

**A**: はい！ENTERキーを押すとマクロが一時停止し、もう一度ENTERキーを押すと同じ場所から再開します。

### Q10: CTRL+YとCTRL+Cの違いは？

**A**: 
- **CTRL+Y**: マクロを停止しますが、プログラムは起動したまま。ENTERで再開可能
- **CTRL+C**: プログラムを完全に終了し、Switchから切断します

---

## 🆘 それでも解決しない場合

1. **`test_connection.bat` を実行** - 自動診断
2. PCを再起動
3. Switchを再起動
4. `reconnect_bluetooth.bat` でBluetooth再接続
5. それでもダメなら、GitHubのIssuesで質問してください

---

## 🎉 楽しいゲームライフを！

このツールが役に立ったら、ぜひ友達にも教えてあげてください！

**Happy Gaming! 🎮✨**

---

## 📝 更新履歴

- v1.1.0 (2025/10/19) - マクロ制御機能強化
  - ENTERキーでマクロの開始/停止を切り替え可能に
  - CTRL+Yでマクロ停止機能追加
  - マクロ実行中の一時停止・再開機能追加
  - より柔軟な操作が可能に

- v1.0.0 (2025/10/19) - 初回リリース
  - ZL+A自動連打機能を実装
  - ワンクリックセットアップ対応
  - 自動管理者権限昇格
  - Bluetooth再接続ヘルパー追加
  - 自動診断ツール搭載

---

**制作者**: coffin299と愉快な仲間たち
**ライセンス**: MIT  
**サポート**: GitHub Issues