# 🎮 Pokemon Legends Z-A 自動金策ツール (Linux/Ubuntu版)

**超簡単！** スクリプト一つでNintendo Switchを自動操作できるツールです。

ZLボタンを押しながらAボタンを自動で連打し続けます。

**ENTERキー**または**CTRL+Y**でマクロの開始/停止を自由に切り替えられます！

---

## 📋 このツールで何ができる？

- **ZL+Aボタンの自動連打** をループ実行
- **ENTERキーで簡単に開始/停止** - いつでも中断・再開可能
- **CTRL+Y でも停止可能** - 素早く止められる
- ゲームの単純作業を自動化できます
- プログラミング知識不要で使えます

---

## 🛠️ 必要なもの

### ハードウェア
- ✅ **Ubuntu 24.04 LTS** がインストールされたPC (または他のDebian系Linux)
- ✅ Bluetooth機能（内蔵またはUSBアダプタ）
- ✅ Nintendo Switch本体

### その他
- インターネット接続（初回セットアップ時のみ）
- 約10分程度の時間（初回セットアップ時のみ）

---

## 📁 ファイル構造

ダウンロードしたフォルダの中身：

```
switch-macro/
│
├── 📄 README.md               ← このファイル（完全ガイド）
├── 📄 LICENSE                 ← MITライセンス
│
├── 🚀 quick_start.sh          ← ★【最初に行う】ワンクリック環境構築スクリプト
├── 🎮 control_panel.sh        ← ★【これで操作】コントロールパネル
│
└── 📁 src/                    ← メインソースコード
    └── switch_macro.py        ← マクロ実行スクリプト
```

### 🎯 どのファイルを使う？

| ファイル | 用途 |
|---------|------|
| `quick_start.sh` | **初回のみ** - 必要なものを全て自動インストールします。 |
| `control_panel.sh` | **毎回使用** - マクロの開始/停止、接続確認など全てここから行います。 |

**`quick_start.sh`で環境構築後、`control_panel.sh`を使うだけ！**

---

## 🚀 初回セットアップ（ワンクリック版）

初めて使うときだけ必要な作業です。**コマンドを3つ実行するだけ！**

### ⏱️ 所要時間: 約10分

---

### 📝 ステップ1: ターミナルを開く

キーボードで `Ctrl + Alt + T` を押して、ターミナル（黒い画面）を開きます。

### 📝 ステップ2: スクリプトを実行

以下のコマンドを**1つずつ**コピー＆ペーストして **Enter** を押してください。

```bash
# 1. ダウンロードしたフォルダに移動します
# 例: cd ~/Downloads/switch-macro
cd /path/to/your/switch-macro

# 2. スクリプトに実行権限を与えます（初回のみ）
chmod +x quick_start.sh

# 3. セットアップスクリプトを実行します
./quick_start.sh
```

実行中にパスワードを聞かれたら、お使いのPCのログインパスワードを入力してください。
（パスワードは入力しても画面に表示されませんが、入力されています）

---

### 🎉 セットアップ完了！

「セットアップがすべて完了しました！」と表示されたら準備完了です。
お疲れ様でした！次回からは「使い方」に進んでください。

---

## 🎯 使い方（毎回）

セットアップが終わったら、以降は**コントロールパネル**を使うだけです。

ターミナルで以下のコマンドを実行します。

```bash
# 1. フォルダに移動
cd /path/to/your/switch-macro

# 2. コントロールパネルを起動
./control_panel.sh
```

メニュー画面が表示されます：

```
========================================
  Nintendo Switch マクロ コントロールパネル
========================================

状態      : [停止中] マクロ停止中
Bluetooth : [接続済] アダプタ有効

========================================

[1] マクロ開始
[2] マクロ停止
[3] Bluetooth再起動
[4] 環境チェック
[5] 状態を更新
[0] 終了

========================================
```

#### 📝 操作手順

1. **Nintendo Switchの準備**
   - ホーム → 「コントローラー」→ 「持ちかた/順番を変える」

2. **マクロ開始**
   - 「**1**」を押してEnter
   - 新しいターミナルウィンドウでマクロが起動

3. **マクロ停止**
   - コントロールパネルのウィンドウに戻り、「**2**」を押してEnter

4. **PC再起動後**
   - もしBluetoothの調子が悪ければ、「**3**」でサービスを再起動できます。

---

## 🎮 操作方法

| キー操作 | 動作 |
|---------|------|
| **ENTER** | マクロ開始 / 一時停止 / 再開 |
| **CTRL+Y** | マクロ停止 |
| **CTRL+C** | プログラム終了・切断 |

### マクロの動作

```
1. ZLボタンを押す（0.5秒）
   ↓
2. ZL+Aを同時に押す（0.1秒）
   ↓
3. 0.5秒待つ
   ↓
4. ENTERキーまたはCTRL+Yを押すまで繰り返し
```

---

## 🔄 PC再起動後の使い方

基本的に、毎回「使い方」セクションの手順を実行するだけです。

もしBluetoothがうまく動作しない場合は、`control_panel.sh`を起動し、「**3**」を押してBluetoothサービスを再起動してみてください。

---

## ⚠️ トラブルシューティング

### 💡 まず試すこと

**`./control_panel.sh` → 「4」環境チェック**

問題の切り分けができます。

---

### 問題1: 「Bluetoothアダプタが見つかりません」「接続できません」

**解決方法**:

1. **コントロールパネルから**
   - `./control_panel.sh` → 「3」Bluetooth再起動

2. **または手動で**
   ```bash
   # ターミナルで実行
   sudo systemctl restart bluetooth
   sleep 3
   hciconfig
   ```
   `UP RUNNING`と表示されていればOKです。

3. **Switchの準備を確認**
   - Switchの「持ちかた/順番を変える」画面が開いているか確認
   - 他のコントローラーをすべて切断

---

### 問題2: ENTERキーやCTRL+Yが効かない

**原因**: ターミナルウィンドウが選択されていない

**解決方法**:
1. マクロが実行されているターミナルウィンドウをクリックして選択状態にする
2. ENTERキーまたはCTRL+Yを押す

---

### 問題3: マクロが停止しない

**解決方法**:

1. **コントロールパネルから**
   - `./control_panel.sh` → 「2」マクロ停止

2. **または手動で**
   ```bash
   # ターミナルで実行
   sudo pkill -f switch_macro.py
   ```

---

### 問題4: 「Permission denied」エラー

**原因**: `sudo`（管理者権限）なしで実行しようとしている

**解決方法**:
必ず `./control_panel.sh` を使って起動してください。このスクリプトは内部で正しく`sudo`を使用します。

---

### 問題5: 「nxbt: command not found」などのエラー

**原因**: Pythonの仮想環境が有効になっていない

**解決方法**:
必ず `./control_panel.sh` を使って起動してください。このスクリプトが自動で仮想環境を有効にします。

---

## 🔧 カスタマイズ（上級者向け）

### マクロの編集

`src/switch_macro.py` をテキストエディタで開いて、以下の部分を編集:

```python
if macro.is_running:
    loop_count += 1
    print(f"🔄 ループ {loop_count}回目...")

    # ここを編集 ↓↓↓
    
    macro.press_button("ZL", 0.5)         # ZLを0.5秒押す
    macro.press_buttons(["ZL", "A"], 0.1) # ZL+A同時押し0.1秒
    macro.wait(0.5)                       # 0.5秒待つ
    
    # ここまで ↑↑↑
```

### 使えるボタン

| ボタン | コード |
|--------|--------|
| A, B, X, Y | `"A"`, `"B"`, `"X"`, `"Y"` |
| L, R | `"L"`, `"R"` |
| ZL, ZR | `"ZL"`, `"ZR"` |
| 十字キー | `"DPAD_UP"`, `"DPAD_DOWN"`, `"DPAD_LEFT"`, `"DPAD_RIGHT"` |
| システム | `"PLUS"`, `"MINUS"`, `"HOME"`, `"CAPTURE"` |

---

## 🗑️ アンインストール

1.  プロジェクトのフォルダを削除します。
    ```bash
    rm -rf /path/to/your/switch-macro
    ```

2.  （任意）セットアップでインストールしたシステムパッケージを削除したい場合：
    ```bash
    sudo apt remove --purge -y python3-pip python3-venv bluez libbluetooth-dev libhidapi-dev
    sudo apt autoremove -y
    ```

---

## ⚖️ リスクと免責事項（重要）

### 🚨 BANのリスク

このツールは**連射コントローラー/マクロコントローラー同様**に自動化ツールです。

#### Nintendo利用規約違反の可能性

自動化手段の使用が明示的に禁止されています。

#### 本体・アカウントBANの可能性

- ✗ eShopへのアクセス不可
- ✗ オンラインマルチプレイ不可
- ✗ ゲームアップデート不可
- ✗ オンライン機能すべて不可

### 💡 安全な使用条件

1. **完全オフライン専用のSwitch**
2. **サブ機での使用**
3. **シングルプレイゲームのみ**
4. **教育・研究目的**

### ⚖️ 法的責任

作成者は使用によって生じたいかなる損害やBANについても責任を負いません。

**使用は完全に自己責任です。**

---

## 📚 よくある質問（FAQ）

### Q1: どのファイルを使えばいいですか？

**A**: 初回は`quick_start.sh`を実行し、その後は**`control_panel.sh`**を使うだけです！

---

### Q2: どのゲームで使えますか？

**A**: すべてのSwitchゲームで動作しますが、オンラインゲームでは使用しないでください。

---

### Q3: PCがスリープしたらどうなる？

**A**: 接続が切れます。`control_panel.sh` → 「3」でBluetoothを再起動してみてください。

---

### Q4: マクロを一時停止して後で再開できますか？

**A**: はい！マクロ実行中のウィンドウでENTERキーを押すと一時停止、もう一度押すと再開します。

---

## 🎉 楽しいゲームライフを！

**Happy Gaming! 🎮✨**

---

## 📝 更新履歴

- v1.2.0 (日付)
  - `run_macro.sh`を廃止し、`control_panel.sh`に操作を一本化
- v1.1.0 (2025/10/19)
  - Linux/Ubuntuに正式対応
  - ワンクリックセットアップスクリプト `quick_start.sh` を追加
  - コントロールパネル `control_panel.sh` を追加

- v1.0.0 (2025/10/19)
  - 初回リリース

---

**制作者**: coffin299と愉快な仲間たち  
**ライセンス**: MIT  
**サポート**: GitHub Issues