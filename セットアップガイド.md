# 🎮 超初心者向けセットアップガイド

**パソコンが苦手でも大丈夫！** 画像を見ながら進めましょう。

---

## 📥 ステップ1: ファイルをダウンロード（3分）

### 1-1. ダウンロード

1. このページの右上にある **緑色の「Code」ボタン** をクリック
2. **「Download ZIP」** をクリック
3. ダウンロードしたZIPファイルを見つける（通常は「ダウンロード」フォルダ）

### 1-2. 解凍

1. ダウンロードした **`pokemon_legends_z-a_money_farm_tool.zip`** を **右クリック**
2. **「すべて展開」** をクリック
3. **「展開」** をクリック

### 1-3. フォルダを移動（推奨）

1. 展開されたフォルダを **わかりやすい場所** に移動

---

## 🚀 ステップ2: セットアップ実行（30分）

### 2-1. setup.batを実行

```
重要！
setup.bat は【ダブルクリック】するだけでOK！
右クリック不要です！
```

1. **`setup.bat`** を **ダブルクリック**
2. 「このアプリがデバイスに変更を加えることを許可しますか？」
   → **「はい」** をクリック

### 2-2. セットアップ開始

黒い画面（コマンドプロンプト）が開きます。

```
╔══════════════════════════════════════════════════════╗
║                                                      ║
║     🎮 Nintendo Switch マクロツール                    ║
║          ワンクリックセットアップ                         ║
║                                                      ║
╚══════════════════════════════════════════════════════╝

セットアップを開始しますか？ (Y/N):
```

**「Y」** を押して **Enterキー**

### 2-3. 自動インストール

以下が自動で実行されます：

1. **WSL2のインストール** ⏱️ 5分
2. **Ubuntu 22.04のインストール** ⏱️ 5分
3. **Python環境のセットアップ** ⏱️ 10分

```
💡 コーヒーでも飲んで待ちましょう ☕
```

### 2-4. 再起動が必要な場合

```
⚠️ 【重要】PCの再起動が必要です！

再起動後、このファイル（setup.bat）をもう一度
【ダブルクリック】してください。

今すぐ再起動しますか？ (Y/N):
```

- **「Y」** → 自動で再起動
- **「N」** → 後で手動で再起動

**再起動後、setup.bat をもう一度ダブルクリック**

### 2-5. Ubuntuの初期設定

新しいウィンドウで「Ubuntu」が開きます。

```
Installing, this may take a few minutes...
Please create a default UNIX user account...

Enter new UNIX username:
```

1. **ユーザー名を入力**（例: `switch`）
2. **Enterキー**
3. **パスワードを入力**
   ```
   💡 パスワードは画面に表示されませんが、
      ちゃんと入力されています！
   ```
4. **もう一度同じパスワードを入力**
5. **Enterキー**

完了したらUbuntuのウィンドウを閉じて、セットアップの画面に戻ります。

---

## 📡 ステップ3: Bluetooth設定（10分）

### 3-1. usbipd-winのインストール

セットアップが自動でインストールを試みます。

**失敗した場合のみ手動でインストール:**

1. [https://github.com/dorssel/usbipd-win/releases](https://github.com/dorssel/usbipd-win/releases) を開く
2. 一番上の **`.msi`** ファイルをクリック
   （例: `usbipd-win_4.0.0.msi`）
3. ダウンロードしたファイルを **ダブルクリック**
4. **「Next」** → **「Next」** → **「Install」**
5. 「このアプリが...」 → **「はい」**

### 3-2. PowerShellを開く

1. キーボードの **Windowsキー** を押す
2. **「PowerShell」** と入力
3. **右クリック** → **「管理者として実行」**
4. 「このアプリが...」 → **「はい」**

青い画面（PowerShell）が開きます。

### 3-3. Bluetoothアダプタを確認

PowerShellに以下を入力:

```powershell
usbipd list
```

**Enterキー** を押す

こんな感じの表示が出ます:

```
BUSID  VID:PID    DEVICE
1-1    046d:c52b  Logitech USB Input Device
2-3    8087:0025  Intel(R) Wireless Bluetooth(R)
3-4    0bda:0129  Realtek USB 2.0 Card Reader
```

**Bluetoothの行を探す**
- 「Bluetooth」「Wireless」などの文字があればそれです
- 左側の **「2-3」** みたいな番号をメモ

```
💡 この例では「2-3」がBluetoothアダプタのBUSIDです
```

### 3-4. Bluetoothアダプタを接続

PowerShellに以下を入力（**2-3は自分のBUSIDに変更**）:

```powershell
usbipd bind --busid 2-3
```

**Enterキー** を押す

次に:

```powershell
usbipd attach --wsl --busid 2-3
```

**Enterキー** を押す

### 3-5. 接続確認

PowerShellに以下を入力:

```powershell
wsl -d Ubuntu-22.04
```

**Enterキー** を押す

Ubuntuに入ったら:

```bash
hciconfig
```

**Enterキー** を押す

以下のように表示されればOK:

```
hci0:   Type: Primary  Bus: USB
        BD Address: XX:XX:XX:XX:XX:XX  ACL MTU: 1021:8  SCO MTU: 64:1
        UP RUNNING
```

「**hci0**」が表示されていればBluetoothアダプタが認識されています！

Ubuntuから抜けるには:

```bash
exit
```

**Enterキー** を押す

---

## 🧪 ステップ4: 接続テスト（推奨）

マクロが正常に動くか確認しましょう。

### 4-1. Switchの準備

1. Nintendo Switchを起動
2. **ホーム画面** → **コントローラー** を選択
3. **「持ちかた/順番を変える」** を選択
4. この画面を開いたまま待機

### 4-2. テスト実行

1. **`test_connection.bat`** を **ダブルクリック**
2. 準備ができたら **Enterキー**
3. 接続が始まります

### 4-3. 成功！

```
✅ 接続成功！
✅ ボタンが正常に動作しました
✅ すべてのテストが成功しました！
```

と表示されればOK！

Switchの画面に新しいコントローラーが表示され、Aボタンが1回押されます。

---

## 🎮 ステップ5: マクロを使う

### 毎回の使い方

1. **Switchの準備**
   - ホーム画面 → コントローラー
   - 「持ちかた/順番を変える」を開く

2. **`run_macro.bat` をダブルクリック**

3. 準備ができたら **Enterキー**

4. **マクロ開始！** 🎉
   - ZL+Aボタンが自動で連打されます
   - やめたい時は **Ctrl+C** （CtrlキーとCキーを同時押し）

---

## ❓ よくある質問

### Q1: 「管理者権限が必要」と出る

**A:** setup.bat を **ダブルクリック** するだけでOK。
「このアプリが...」と出たら **「はい」** をクリック。

### Q2: 「usbipd: command not found」と出る

**A:** usbipd-winがインストールされていません。
ステップ3-1を再度実行してください。

### Q3: 「hci0」が表示されない

**A:** Bluetoothアダプタが接続されていません。
ステップ3-4をもう一度実行してください。

### Q4: Switchに接続できない

**A:** 以下を確認:
- Switchの「持ちかた/順番を変える」画面が開いているか
- 他のコントローラーが接続されていないか
- Bluetoothアダプタが認識されているか（hciconfig で確認）

### Q5: PCを再起動したらマクロが動かなくなった

**A:** PowerShellで以下を実行:

```powershell
usbipd attach --wsl --busid 2-3
```

（2-3は自分のBUSID）

---

## 🆘 それでも解決しない場合

1. **トラブルシューティングを実行:**
   - `test_connection.bat` をダブルクリック
   - 失敗したら「Y」を押して診断実行

2. **手動診断:**
   - PowerShellを開く
   - 以下を実行:
     ```powershell
     wsl -d Ubuntu-22.04
     bash ~/switch-macro/scripts/troubleshoot.sh
     ```

3. **それでもダメなら:**
   - README.md の「トラブルシューティング」を参照
   - GitHub Issues で質問

---

## 🎉 完了！

これであなたもマクロの使い手です！

**Happy Gaming! 🎮✨**

---

## 📞 サポート

困ったことがあれば:
- **README.md** - 詳しい説明
- **QUICKSTART.md** - 簡単ガイド
- **GitHub Issues** - 質問・相談

---

## ⚠️ 注意事項

- このツールは**教育目的**です
- **オンラインゲームでは使用しない**でください
- ゲームの利用規約を確認してください
- **使用は自己責任**です

詳しくは README.md の「リスクと免責事項」を必ず読んでください。